<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <title>Copy Data dari Google Sheets</title>
</head>
<body>
  <button onclick="copyData()">Copy Data 1</button>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRAV3oPmr3m2ULsW4hPdf0s-cOWpFRS8eVJGVDROIyDUH0YKy1XZz1WefGQqH9ypWPDpYITEYT09WE0/pub?gid=0&single=true&output=csv";

    // Parser CSV yang menghargai tanda kutip
    function parseCSVLine(line) {
      const result = [];
      let current = "";
      let inQuotes = false;

      for (let i = 0; i < line.length; i++) {
        const char = line[i];
        if (char === '"') {
          inQuotes = !inQuotes; // buka/tutup kutipan
        } else if (char === ',' && !inQuotes) {
          result.push(current);
          current = "";
        } else {
          current += char;
        }
      }
      result.push(current);
      return result;
    }

    async function copyData(){
      try {
        const res = await fetch(sheetURL);
        const csv = await res.text();

        // Konversi CSV ke TSV
        const tsv = csv
          .split(/\r?\n/)                     // pecah per baris
          .filter(row => row.trim() !== "")   // buang baris kosong
          .map(row => parseCSVLine(row).join("\t")) // parse kolom dengan aman
          .join("\r\n");

        await navigator.clipboard.writeText(tsv);
        alert("Data berhasil disalin! Buka Excel → pilih sel C6 → Ctrl+V.");
      } catch(err) {
        alert("Gagal mengambil data: " + err);
      }
    }
  </script>
</body>
</html>
